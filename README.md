# php-reactjs

## 概要

ReactJS のチュートリアルを PHP として動くようにReactJSのコアをPHPで再現してみたもの、
という世の中的には何の意味もないモジュールです。

`普通の PHPer なら JS のまま ReactJS を習得するが、より練度の高い PHPer ならば PHP に再実装して ReactJS を理解するはずだ`
という某 LT に感銘を受けての産物です。

[チュートリアルの jsx版 と PHP版 のソースの比較はこちら](https://github.com/waterada/reactjs-php/compare/master...jsx?diff=split&name=jsx&w=1)


## コンセプト

- jsx 版は ajax (ブラウザ - サーバ) でやり取りするが、PHP 版では１層下げて、サーバ内 (PHP - ファイル) のやり取りで、これを模する。
- チュートリアルの記述をできるだけ忠実に再現する。
- ReactJS のコンセプトをできるだけ壊さない。（これを知ることが重要な目的の１つなので。）

## 期待する成果

- 上位 DOM から下位へと値の渡していく、変更は state のみに行い、DOM 対して直に行わないというコンセプトの良さの体感。
- 疎結合がやりやすくなると期待しているが、その勘所の体感。

## できなかったこと（＝ PHP に比べて jsx 版が優れているところ）

- DOM の変更差分のみ更新するところ (PHPは常に全 DOM 更新)
- jsx の XML 的な表記の完全な再現。
- XML 的な表現の中で props などの戻り値は自動的にエスケープされて埋めれられるのだが、それを模することはできなかった。XMLパーサを自作するしかない。

## 苦労した所

- jsx の XML 的な表記を近づける所。（ReactJSの理解とは本質的に無関係なのだが。。。）
- 値の渡し間違いで動かない場合のデバッグ。コアが安定していさえすれば、疎結合になるので簡単になるはずなのだが。

## ReactJS とは何なのか

- `render()` で DOM を返却する。
- DOM と同じ場所に `state` (状態) の変更処理も実装する。(DOM の変更処理は存在しない。)
- `state` が変わったら、DOM を再構築している( `render()` を再度呼ぶ)。
- DOM 再構築のパフォーマンスを上げるために再構築あ必要な場所（stateの下位）に限定している。
- DOM 再描画のパフォーマンスを上げるために差分のみ描画している(上記と同時かも)。
- `props` というのは変更されない値で上位から渡ってくる。
- `state` は、その Component 内で変更されうる値だが、`render()` には一旦固まっている。(`render()` 後に変更されたら再 render する。)

## 面白い気づき

- ヒアドキュメントで `{${...}}` という記法で静的なものも呼べるが、名前空間の扱いが独特で、あまり使えない。
- あとで書く。
